<!-- The top of file index.html -->
<html lang="en">
	<head>
	<meta name="google-signin-scope" content="profile email https://www.googleapis.com/auth/business.manage">
	<meta name="google-signin-client_id" content="580732406832-ofnbkdpq6oshiirmj0pcngf7ro195o44.apps.googleusercontent.com">
	<script src="https://apis.google.com/js/platform.js" async defer></script>
	</head>
	<body>
	<div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>
	<script>
		var gmb_api_version = 'https://mybusiness.googleapis.com/v4';
		var accounts = [];
		var user = null;
		function onSignIn(googleUser) {
			user = googleUser;

			// Useful data for your client-side scripts:
			var profile = googleUser.getBasicProfile();
			console.log('Full Name: ' + profile.getName());
			console.log("Email: " + profile.getEmail());
			var access_token = googleUser.getAuthResponse().access_token;

			//Using the sign in data to make a Google My Business API call
			var req = gmb_api_version + '/accounts';
			var xhr = new XMLHttpRequest();
			xhr.open('GET', req);
			xhr.setRequestHeader('Authorization', 'Bearer ' + access_token);

			//Displaying the API response
			xhr.onload = function () {
				document.body.appendChild(document.createTextNode(xhr.responseText));
				
			}
			xhr.send();
		}

		function getReviews() {
			// Useful data for your client-side scripts:
			var profile = user.getBasicProfile();
			
			var access_token = user.getAuthResponse().access_token;
			console.log(access_token);
			//Using the sign in data to make a Google My Business API call
			var req = gmb_api_version + '/accounts/102840914882656560614/locations/ChIJF5QjNGuMsUcRCLir6MPxVcg/reviews';
			var xhr = new XMLHttpRequest();
			xhr.open('GET', req);
			xhr.setRequestHeader('Authorization', 'Bearer ' + access_token);

			//Displaying the API response
			xhr.onload = function () {
				//document.body.appendChild(document.createTextNode(xhr.responseText));
				console.log(xhr.responseText);
			}
			xhr.send();
		}
		getReviews();

		////
	</script>
	</body>
</html>
